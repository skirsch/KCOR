================================================================================
KCOR v4.4 - Kirsch Cumulative Outcomes Ratio Analysis
================================================================================
Analysis Date: 2025-09-29 21:54:38
Mode: Primary Analysis
Input File: ../data/Czech/KCOR_CMR.xlsx
Output File: ../data/Czech/KCOR.xlsx
Log File: ../data/Czech/KCOR_summary.log
--------------------------------------------------------------------------------
Configuration Parameters (effective):
  FINAL_KCOR_MIN        = 0
  FINAL_KCOR_DATE       = 4/1/24
  KCOR_NORMALIZATION_WEEK = 4
  SLOPE_ANCHOR_T        = 0
  DYNAMIC_HVE_SKIP_WEEKS = 0
  AGE_RANGE             = 10
  SLOPE_WINDOW_SIZE     = 2
  MA_TOTAL_LENGTH       = 8
  CENTERED              = True
  YEAR_RANGE            = (1920, 2009)
  ENROLLMENT_DATES      = ['2021_13', '2021_24', '2022_06', '2022_47']
  DEBUG_VERBOSE         = True
  OVERRIDE_DOSE_PAIRS   = None
  OVERRIDE_YOBS         = None
  QUIET_ANCHOR_ISO_WEEKS= ['2022-25', '2023-28', '2024-15']
  MIN_ANCHOR_GAP_WEEKS  = 26
  MIN_ANCHOR_SEPARATION_WEEKS = 39
  KCOR_REPORTING_DATE   = {'2021-13': '2022-12-31', '2021_13': '2022-12-31', '2021_24': '2022-12-31', '2022_06': '2022-12-31', '2022_47': '2023-12-31'}
  SLOPE_NORMALIZE_YOB_LE= 0
  NEGATIVE_CONTROL_MODE = 1
================================================================================

[DEBUG] Limiting to age range: 1920-2009
[DEBUG] Limiting to enrollment dates: ['2021_13', '2021_24', '2022_06', '2022_47']
[Info] Processing sheet: 2021_13
[DEBUG] Filtered to start from enrollment date 03/29/2021: 141525 rows
[DEBUG] Filtered to 133200 rows for ages 1920-2009
[DEBUG] Filtered to doses [0, 1, 2] (max dose 2): 79920 rows
[DEBUG] Aggregated across sexes: 4995 rows
[INFO] 2021_13 dynamic anchors: t=64 (2022-06-20), t=119 (2023-07-10), Δt=55 weeks

[DEBUG] Computed slopes for sheet 2021_13:
  YoB 1920, Dose 0: slope = -0.003816
  YoB 1930, Dose 0: slope = -0.001640
  YoB 1940, Dose 0: slope = -0.000052
  YoB 1950, Dose 0: slope = 0.000548
  YoB 1960, Dose 0: slope = 0.001188
  YoB 1970, Dose 0: slope = 0.001178
  YoB 1980, Dose 0: slope = 0.001901
  YoB 1990, Dose 0: slope = 0.002549
  YoB 2000, Dose 0: slope = -0.000307
  YoB 1920, Dose 1: slope = 0.000867
  YoB 1930, Dose 1: slope = 0.000062
  YoB 1940, Dose 1: slope = 0.002133
  YoB 1950, Dose 1: slope = 0.000866
  YoB 1960, Dose 1: slope = -0.001542
  YoB 1970, Dose 1: slope = 0.005520
  YoB 1980, Dose 1: slope = 0.003619
  YoB 1990, Dose 1: slope = 0.000447
  YoB 2000, Dose 1: slope = 0.000000
  YoB 1920, Dose 2: slope = 0.002204
  YoB 1930, Dose 2: slope = 0.001480
  YoB 1940, Dose 2: slope = 0.001488
  YoB 1950, Dose 2: slope = 0.000053
  YoB 1960, Dose 2: slope = -0.004411
  YoB 1970, Dose 2: slope = 0.003127
  YoB 1980, Dose 2: slope = 0.017227
  YoB 1990, Dose 2: slope = 0.007070
  YoB 2000, Dose 2: slope = 0.000000
  YoB 1920, total slope = -0.000521  % vaxxed=58  (u,v)=(17291, 24009)
  YoB 1930, total slope = 0.000116  % vaxxed=66  (u,v)=(108468, 208980)
  YoB 1940, total slope = 0.000848  % vaxxed=43  (u,v)=(535775, 407907)
  YoB 1950, total slope = 0.000553  % vaxxed=10  (u,v)=(1146274, 124352)
  YoB 1960, total slope = 0.000788  % vaxxed=10  (u,v)=(1166254, 129324)
  YoB 1970, total slope = 0.001421  % vaxxed=8  (u,v)=(1580142, 131298)
  YoB 1980, total slope = 0.002346  % vaxxed=5  (u,v)=(1359745, 72486)
  YoB 1990, total slope = 0.002604  % vaxxed=4  (u,v)=(1112039, 44473)
  YoB 2000, total slope = -0.000305  % vaxxed=1  (u,v)=(1042593, 5337)

Sanity check: All comoputed slopes should be positive since people don't get younger.
[Info] Processing sheet: 2021_24
[DEBUG] Filtered to start from enrollment date 06/14/2021: 133110 rows
[DEBUG] Filtered to 125280 rows for ages 1920-2009
[DEBUG] Filtered to doses [0, 1, 2] (max dose 2): 75168 rows
[DEBUG] Aggregated across sexes: 4698 rows
[INFO] 2021_24 dynamic anchors: t=53 (2022-06-20), t=108 (2023-07-10), Δt=55 weeks

[DEBUG] Computed slopes for sheet 2021_24:
  YoB 1920, Dose 0: slope = -0.003878
  YoB 1930, Dose 0: slope = -0.002502
  YoB 1940, Dose 0: slope = -0.002040
  YoB 1950, Dose 0: slope = -0.000723
  YoB 1960, Dose 0: slope = -0.000469
  YoB 1970, Dose 0: slope = -0.000085
  YoB 1980, Dose 0: slope = 0.000405
  YoB 1990, Dose 0: slope = 0.002004
  YoB 2000, Dose 0: slope = -0.001467
  YoB 1920, Dose 1: slope = -0.003542
  YoB 1930, Dose 1: slope = -0.000762
  YoB 1940, Dose 1: slope = 0.001182
  YoB 1950, Dose 1: slope = 0.001658
  YoB 1960, Dose 1: slope = 0.003468
  YoB 1970, Dose 1: slope = 0.003555
  YoB 1980, Dose 1: slope = 0.008535
  YoB 1990, Dose 1: slope = 0.004422
  YoB 2000, Dose 1: slope = 0.016821
  YoB 1920, Dose 2: slope = 0.001551
  YoB 1930, Dose 2: slope = 0.001003
  YoB 1940, Dose 2: slope = 0.001955
  YoB 1950, Dose 2: slope = 0.000978
  YoB 1960, Dose 2: slope = 0.000286
  YoB 1970, Dose 2: slope = 0.003173
  YoB 1980, Dose 2: slope = 0.006615
  YoB 1990, Dose 2: slope = 0.004360
  YoB 2000, Dose 2: slope = 0.000000
  YoB 1920, total slope = -0.000480  % vaxxed=71  (u,v)=(11340, 27811)
  YoB 1930, total slope = 0.000152  % vaxxed=81  (u,v)=(59085, 251361)
  YoB 1940, total slope = 0.001088  % vaxxed=82  (u,v)=(169274, 766292)
  YoB 1950, total slope = 0.000779  % vaxxed=75  (u,v)=(316378, 949449)
  YoB 1960, total slope = 0.001405  % vaxxed=63  (u,v)=(475613, 818224)
  YoB 1970, total slope = 0.001884  % vaxxed=55  (u,v)=(761808, 948849)
  YoB 1980, total slope = 0.003263  % vaxxed=37  (u,v)=(899514, 532469)
  YoB 1990, total slope = 0.002457  % vaxxed=19  (u,v)=(937986, 218424)
  YoB 2000, total slope = -0.000754  % vaxxed=5  (u,v)=(997230, 50679)

Sanity check: All comoputed slopes should be positive since people don't get younger.
[Info] Processing sheet: 2022_06
[DEBUG] Filtered to start from enrollment date 02/07/2022: 107100 rows
[DEBUG] Filtered to 100800 rows for ages 1920-2009
[DEBUG] Filtered to doses [0, 1, 2, 3] (max dose 3): 80640 rows
[DEBUG] Aggregated across sexes: 5040 rows
[INFO] 2022_06 dynamic anchors: t=74 (2023-07-10), t=113 (2024-04-08), Δt=39 weeks

[DEBUG] Computed slopes for sheet 2022_06:
  YoB 1920, Dose 0: slope = 0.003418
  YoB 1930, Dose 0: slope = 0.000683
  YoB 1940, Dose 0: slope = -0.000326
  YoB 1950, Dose 0: slope = 0.000017
  YoB 1960, Dose 0: slope = -0.001764
  YoB 1970, Dose 0: slope = -0.002412
  YoB 1980, Dose 0: slope = -0.003539
  YoB 1990, Dose 0: slope = -0.003980
  YoB 2000, Dose 0: slope = 0.000368
  YoB 1920, Dose 1: slope = 0.001725
  YoB 1930, Dose 1: slope = 0.000327
  YoB 1940, Dose 1: slope = 0.004021
  YoB 1950, Dose 1: slope = -0.000856
  YoB 1960, Dose 1: slope = -0.003085
  YoB 1970, Dose 1: slope = 0.009618
  YoB 1980, Dose 1: slope = 0.010966
  YoB 1990, Dose 1: slope = 0.020415
  YoB 2000, Dose 1: slope = -0.007104
  YoB 1920, Dose 2: slope = -0.002159
  YoB 1930, Dose 2: slope = 0.001089
  YoB 1940, Dose 2: slope = 0.000410
  YoB 1950, Dose 2: slope = -0.003880
  YoB 1960, Dose 2: slope = 0.000975
  YoB 1970, Dose 2: slope = -0.000183
  YoB 1980, Dose 2: slope = -0.002014
  YoB 1990, Dose 2: slope = -0.011207
  YoB 2000, Dose 2: slope = -0.006542
  YoB 1920, Dose 3: slope = 0.000279
  YoB 1930, Dose 3: slope = 0.002997
  YoB 1940, Dose 3: slope = 0.002120
  YoB 1950, Dose 3: slope = 0.001105
  YoB 1960, Dose 3: slope = 0.001094
  YoB 1970, Dose 3: slope = -0.003568
  YoB 1980, Dose 3: slope = -0.008418
  YoB 1990, Dose 3: slope = -0.008658
  YoB 2000, Dose 3: slope = -0.042568
  YoB 1920, total slope = 0.000701  % vaxxed=79  (u,v)=(6742, 25271)
  YoB 1930, total slope = 0.002425  % vaxxed=88  (u,v)=(35371, 252148)
  YoB 1940, total slope = 0.001757  % vaxxed=90  (u,v)=(93174, 817874)
  YoB 1950, total slope = 0.000204  % vaxxed=86  (u,v)=(169821, 1081798)
  YoB 1960, total slope = 0.000245  % vaxxed=79  (u,v)=(266299, 1022121)
  YoB 1970, total slope = -0.001536  % vaxxed=76  (u,v)=(418011, 1290099)
  YoB 1980, total slope = -0.003395  % vaxxed=68  (u,v)=(463431, 967590)
  YoB 1990, total slope = -0.005646  % vaxxed=65  (u,v)=(406232, 749799)
  YoB 2000, total slope = -0.006910  % vaxxed=59  (u,v)=(433934, 613790)

Sanity check: All comoputed slopes should be positive since people don't get younger.
[Info] Processing sheet: 2022_47
[DEBUG] Filtered to start from enrollment date 11/21/2022: 75735 rows
[DEBUG] Filtered to 71280 rows for ages 1920-2009
[DEBUG] Filtered to doses [0, 1, 2, 3, 4] (max dose 4): 71280 rows
[DEBUG] Aggregated across sexes: 4455 rows
[INFO] 2022_47 dynamic anchors: t=33 (2023-07-10), t=72 (2024-04-08), Δt=39 weeks

[DEBUG] Computed slopes for sheet 2022_47:
  YoB 1920, Dose 0: slope = 0.003529
  YoB 1930, Dose 0: slope = 0.001027
  YoB 1940, Dose 0: slope = -0.000325
  YoB 1950, Dose 0: slope = 0.000031
  YoB 1960, Dose 0: slope = -0.001875
  YoB 1970, Dose 0: slope = -0.002263
  YoB 1980, Dose 0: slope = -0.003352
  YoB 1990, Dose 0: slope = -0.004510
  YoB 2000, Dose 0: slope = -0.000218
  YoB 1920, Dose 1: slope = -0.002362
  YoB 1930, Dose 1: slope = -0.000384
  YoB 1940, Dose 1: slope = 0.004375
  YoB 1950, Dose 1: slope = 0.000257
  YoB 1960, Dose 1: slope = -0.003075
  YoB 1970, Dose 1: slope = 0.010797
  YoB 1980, Dose 1: slope = 0.013958
  YoB 1990, Dose 1: slope = 0.016476
  YoB 2000, Dose 1: slope = 0.008589
  YoB 1920, Dose 2: slope = -0.000626
  YoB 1930, Dose 2: slope = 0.001961
  YoB 1940, Dose 2: slope = 0.001697
  YoB 1950, Dose 2: slope = -0.005262
  YoB 1960, Dose 2: slope = 0.001270
  YoB 1970, Dose 2: slope = 0.000037
  YoB 1980, Dose 2: slope = -0.002972
  YoB 1990, Dose 2: slope = -0.006584
  YoB 2000, Dose 2: slope = -0.011355
  YoB 1920, Dose 3: slope = 0.000011
  YoB 1930, Dose 3: slope = 0.002883
  YoB 1940, Dose 3: slope = 0.001215
  YoB 1950, Dose 3: slope = 0.001035
  YoB 1960, Dose 3: slope = 0.000671
  YoB 1970, Dose 3: slope = -0.002013
  YoB 1980, Dose 3: slope = -0.003403
  YoB 1990, Dose 3: slope = -0.012198
  YoB 2000, Dose 3: slope = -0.009039
  YoB 1920, Dose 4: slope = 0.000489
  YoB 1930, Dose 4: slope = 0.002424
  YoB 1940, Dose 4: slope = 0.003272
  YoB 1950, Dose 4: slope = 0.001170
  YoB 1960, Dose 4: slope = 0.002458
  YoB 1970, Dose 4: slope = -0.015946
  YoB 1980, Dose 4: slope = -0.029586
  YoB 1990, Dose 4: slope = -0.002053
  YoB 2000, Dose 4: slope = 0.000000
  YoB 1920, total slope = 0.000670  % vaxxed=81  (u,v)=(4747, 20096)
  YoB 1930, total slope = 0.002383  % vaxxed=89  (u,v)=(29755, 231739)
  YoB 1940, total slope = 0.001715  % vaxxed=90  (u,v)=(86740, 796080)
  YoB 1950, total slope = 0.000296  % vaxxed=87  (u,v)=(164073, 1071661)
  YoB 1960, total slope = 0.000172  % vaxxed=80  (u,v)=(261694, 1020720)
  YoB 1970, total slope = -0.001285  % vaxxed=76  (u,v)=(412512, 1292756)
  YoB 1980, total slope = -0.002643  % vaxxed=68  (u,v)=(456849, 973197)
  YoB 1990, total slope = -0.005517  % vaxxed=65  (u,v)=(399235, 756407)
  YoB 2000, total slope = -0.005683  % vaxxed=59  (u,v)=(426359, 621152)

Sanity check: All comoputed slopes should be positive since people don't get younger.
[NegativeControl] Wrote 105 rows to ../data/data/negative_control_test_summary.xlsx
[NegativeControl] Skipping normal workbook/summary outputs.
