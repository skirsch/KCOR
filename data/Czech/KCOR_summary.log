================================================================================
KCOR v4.5 - Kirsch Cumulative Outcomes Ratio Analysis
================================================================================
Analysis Date: 2025-09-30 19:48:48
Mode: Primary Analysis
Input File: ../data/Czech/KCOR_CMR.xlsx
Output File: ../data/Czech/KCOR.xlsx
Log File: ../data/Czech/KCOR_summary.log
--------------------------------------------------------------------------------
Configuration Parameters (effective):
  FINAL_KCOR_MIN        = 0
  FINAL_KCOR_DATE       = 4/1/24
  KCOR_NORMALIZATION_WEEK = 4
  DYNAMIC_HVE_SKIP_WEEKS = 0
  AGE_RANGE             = 10
  MA_TOTAL_LENGTH       = 8
  CENTERED              = True
  YEAR_RANGE            = (1920, 2009)
  ENROLLMENT_DATES      = ['2021_13', '2021_24', '2022_06', '2022_47']
  DEBUG_VERBOSE         = True
  OVERRIDE_DOSE_PAIRS   = None
  OVERRIDE_YOBS         = None
  KCOR_REPORTING_DATE   = {'2021-13': '2022-12-31', '2021_13': '2022-12-31', '2021_24': '2022-12-31', '2022_06': '2022-12-31', '2022_47': '2023-12-31'}
  SLOPE_NORMALIZE_YOB_LE= 0
  NEGATIVE_CONTROL_MODE = 0
  SIN_ENABLED           = 1
  SIN_WINDOW            = (2023-18, 2023-44)
================================================================================

[DEBUG] Limiting to age range: 1920-2009
[DEBUG] Limiting to enrollment dates: ['2021_13', '2021_24', '2022_06', '2022_47']
[Info] Processing sheet: 2021_13
[DEBUG] Filtered to start from enrollment date 03/29/2021: 141525 rows
[DEBUG] Filtered to 133200 rows for ages 1920-2009
[DEBUG] Filtered to doses [0, 1, 2] (max dose 2): 79920 rows
[DEBUG] Aggregated across sexes: 4995 rows
[INFO] 2021_13 dynamic anchors: t=64 (2022-06-20), t=119 (2023-07-10), Δt=55 weeks

[DEBUG] Computed slopes for sheet 2021_13:
  YoB 1920, Dose 0: slope = -0.003816
  YoB 1930, Dose 0: slope = -0.001640
  YoB 1940, Dose 0: slope = -0.000052
  YoB 1950, Dose 0: slope = 0.000548
  YoB 1960, Dose 0: slope = 0.001188
  YoB 1970, Dose 0: slope = 0.001178
  YoB 1980, Dose 0: slope = 0.001901
  YoB 1990, Dose 0: slope = 0.002549
  YoB 2000, Dose 0: slope = -0.000307
  YoB 1920, Dose 1: slope = 0.000867
  YoB 1930, Dose 1: slope = 0.000062
  YoB 1940, Dose 1: slope = 0.002133
  YoB 1950, Dose 1: slope = 0.000866
  YoB 1960, Dose 1: slope = -0.001542
  YoB 1970, Dose 1: slope = 0.005520
  YoB 1980, Dose 1: slope = 0.003619
  YoB 1990, Dose 1: slope = 0.000447
  YoB 2000, Dose 1: slope = 0.000000
  YoB 1920, Dose 2: slope = 0.002204
  YoB 1930, Dose 2: slope = 0.001480
  YoB 1940, Dose 2: slope = 0.001488
  YoB 1950, Dose 2: slope = 0.000053
  YoB 1960, Dose 2: slope = -0.004411
  YoB 1970, Dose 2: slope = 0.003127
  YoB 1980, Dose 2: slope = 0.017227
  YoB 1990, Dose 2: slope = 0.007070
  YoB 2000, Dose 2: slope = 0.000000
  YoB 1920, total slope = -0.000521  % vaxxed=58  (u,v)=(17291, 24009)
  YoB 1930, total slope = 0.000116  % vaxxed=66  (u,v)=(108468, 208980)
  YoB 1940, total slope = 0.000848  % vaxxed=43  (u,v)=(535775, 407907)
  YoB 1950, total slope = 0.000553  % vaxxed=10  (u,v)=(1146274, 124352)
  YoB 1960, total slope = 0.000788  % vaxxed=10  (u,v)=(1166254, 129324)
  YoB 1970, total slope = 0.001421  % vaxxed=8  (u,v)=(1580142, 131298)
  YoB 1980, total slope = 0.002346  % vaxxed=5  (u,v)=(1359745, 72486)
  YoB 1990, total slope = 0.002604  % vaxxed=4  (u,v)=(1112039, 44473)
  YoB 2000, total slope = -0.000305  % vaxxed=1  (u,v)=(1042593, 5337)

Note: Note that computed mortality rate slopes should be positive since people don't get younger.
[DBG-BUG] Sheet 2021_13: YoB 1950, Dose 2, estimated slope = 0.000053
[DBG-BUG] 2022-01-10 — Alive=39323, Dead=9, MR=0.00022887, MR_adj=0.00022887
[DBG-BUG] 2022-01-17 — Alive=39314, Dead=8, MR=0.00020349, MR_adj=0.00020349
[DBG-BUG] SIN beta for YoB 1950, Dose 2: 0.01828088
[DBG-BUG] 2022-01-10 — t=41, hazard=0.0002288999, CH_so_far=nan
[DBG-BUG] 2022-01-17 — t=42, hazard=0.0002035106, CH_so_far=nan
[Info] Processing sheet: 2021_24
