make -C test/sensitivity all DATASET=Czech
SENSITIVITY_ANALYSIS=1 \
SA_COHORTS="2022_06" SA_DOSE_PAIRS="1,0" \
SA_TAU_VALUES="0.2,0.5" SA_NORM_WEEKS="4" \
python3 ../../code/KCOR.py ../../data/Czech/KCOR_CMR.xlsx ../../test/sensitivity/out/KCOR_SA.xlsx "Sensitivity Analysis" KCOR_summary_SA.log
Traceback (most recent call last):
  File "/mnt/c/Users/stk/Documents/GitHub/KCOR/test/sensitivity/../../code/KCOR.py", line 3336, in create_sa_grid_output
    with pd.ExcelWriter(sa_path, engine="openpyxl") as writer:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3/dist-packages/pandas/io/excel/_openpyxl.py", line 60, in __init__
    super().__init__(
  File "/usr/lib/python3/dist-packages/pandas/io/excel/_base.py", line 1313, in __init__
    self._handles = get_handle(
                    ^^^^^^^^^^^
  File "/usr/lib/python3/dist-packages/pandas/io/common.py", line 865, in get_handle
    handle = open(handle, ioargs.mode)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
PermissionError: [Errno 13] Permission denied: '../../test/sensitivity/out/KCOR_SA.xlsx'
[DEBUG] Overriding dose pairs via SA_DOSE_PAIRS: [(1, 0)]
================================================================================
KCOR v5.4 - Kirsch Cumulative Outcomes Ratio Analysis
================================================================================
Analysis Date: 2025-12-18 20:32:48
Mode: Sensitivity Analysis
Input File: ../../data/Czech/KCOR_CMR.xlsx
SA Output File: ../../test/sensitivity/out/KCOR_SA.xlsx
Log File: ../../test/sensitivity/out/KCOR_summary_SA.log
(Standard multi-sheet workbook suppressed in SA mode)
--------------------------------------------------------------------------------
Configuration Parameters (effective):
  KCOR_NORMALIZATION_WEEKS = 4
  DYNAMIC_HVE_SKIP_WEEKS = 2
  AGE_RANGE             = 10
  YEAR_RANGE            = (1920, 2009)
  ENROLLMENT_DATES      = ['2022_06']
  DEBUG_VERBOSE         = True
  OVERRIDE_DOSE_PAIRS   = [(1, 0)]
  OVERRIDE_YOBS         = None
  KCOR_REPORTING_DATE   = {'2021-13': '2022-12-31', '2021_13': '2022-12-31', '2021-20': '2022-12-31', '2021_20': '2022-12-31', '2021_24': '2022-12-31', '2022_06': '2022-12-31', '2022_47': '2023-12-31'}
  NEGATIVE_CONTROL_MODE = 0
  SLOPE6_METHOD        = QuantReg (tau=0.5)  [Slope6: Time-centered linear quantile regression normalization for b >= 0]
  SLOPE8_METHOD        = Quantile Regression (L-BFGS-B)  [Slope8: Depletion-mode normalization for all cohorts]
  SLOPE6_QUANTILE_TAU  = 0.5  [Quantile level for quantile regression (0.5 = median)]
  SLOPE6_FIT_WINDOW    = 2022-01 to 2024-12  [Fixed window for regression fitting]
  SLOPE6_APPLICATION_ENDPOINT = 2024-16  [Rightmost endpoint for determining centerpoint]
  SLOPE6_BASELINE_WINDOW_LENGTH_MIN = 30 weeks
  SLOPE6_BASELINE_WINDOW_LENGTH_MAX = 60 weeks
  SLOPE6_BASELINE_START_YEAR = 2023
  SLOPE6_MIN_DATA_POINTS = 5
================================================================================

[DEBUG] Limiting to age range: 1920-2009
[DEBUG] Limiting to enrollment dates: ['2022_06']
SLOPE6_FIT_WINDOW,selected=2022-01..2024-16 (week 1 of 2022 through 2024-16, fixed)
[Slope6] Using fit window: 2022-01 to 2024-16
[Slope6] Application endpoint: 2024-16 (rightmost point for determining centerpoint)
[SA] Overriding tau values via SA_TAU_VALUES=0.2,0.5 -> [0.2, 0.5]
[SA] Overriding normalization weeks via SA_NORM_WEEKS=4 -> [4]
[SA] Starting sensitivity analysis with 2 tau values and 1 normalization weeks
[SA] Total parameter combinations: 2
[SA] Processing combination 1/2: tau=0.2, norm_weeks=4
[SA] Restricting cohort 2022_06 to doses [0, 1] (from SA_DOSE_PAIRS)
SLOPE8_FIT,EnrollmentDate=2022_06,YoB=-2,Dose=0,mode=linear(yob_threshold),a=-9.004665e+00,b=-2.137777e-03,c=0.000000e+00,t_mean=5.800000e+01,rms_error=1.652329e-01,points=113,skip_weeks=2
SLOPE8_FIT,EnrollmentDate=2022_06,YoB=-2,Dose=1,mode=linear(yob_threshold),a=-8.655510e+00,b=-3.525161e-03,c=0.000000e+00,t_mean=6.550000e+01,rms_error=3.285930e-01,points=98,skip_weeks=17

[DEBUG] Expected-deaths weights for ASMR pooling:
  Age -2: weight = 1.000000
  Total weight: 1.000000

[SA] Processing combination 2/2: tau=0.5, norm_weeks=4
[SA] Restricting cohort 2022_06 to doses [0, 1] (from SA_DOSE_PAIRS)
SLOPE8_FIT,EnrollmentDate=2022_06,YoB=-2,Dose=0,mode=linear(yob_threshold),a=-8.904779e+00,b=-2.461405e-03,c=0.000000e+00,t_mean=5.800000e+01,rms_error=1.204363e-01,points=113,skip_weeks=2
SLOPE8_FIT,EnrollmentDate=2022_06,YoB=-2,Dose=1,mode=linear(yob_threshold),a=-8.458905e+00,b=-4.819712e-03,c=0.000000e+00,t_mean=6.550000e+01,rms_error=2.622893e-01,points=98,skip_weeks=17

[DEBUG] Expected-deaths weights for ASMR pooling:
  Age -2: weight = 1.000000
  Total weight: 1.000000

[SA] Creating grid output with 1 cohorts and 1 dose pairs
[SA] Error creating grid output: [Errno 13] Permission denied: '../../test/sensitivity/out/KCOR_SA.xlsx'
